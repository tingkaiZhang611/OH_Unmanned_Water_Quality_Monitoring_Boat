import { PostUtil } from '../Component/Web';
import { JoystickComponent } from '../pages/yaoGan';


@Component
export struct YaoKong {
  @State data: string[] = ['hppâ™¥ğŸ¥£ğŸ¦Œ', 'é”®å…¥å†…å®¹ä»¥æ·»åŠ ...']
  @State Xed: number = 0;
  @State Yed: number = 0;
  @State BaiFen: number = 100;
  @State direction1: number = 0; // æ–°å¢ï¼šæ–¹å‘çŠ¶æ€å˜é‡
  private pre:string='ä¸­å¿ƒ';
  @State gpsOk:boolean=true;
  poster:PostUtil=new PostUtil();

  build() {
    RelativeContainer() {
      Column() {
        // ä¿®æ”¹ï¼šæ·»åŠ æ–¹å‘æ˜¾ç¤º
        Text('OpenHarmonyæ— äººæ°´è´¨ç›‘æµ‹èˆ¹\n\nå½“å‰æ“çºµæ†åæ ‡' +
          '\n\nX:' + this.Xed.toFixed(2) +
          '\nY:' + this.Yed.toFixed(2) +
          '\næ–¹å‘:' + this.getDirectionText())
          .fontSize(24)
          .fontColor('#ffffffff')
          .backgroundColor('#ff3590f9')
          .padding(16)
          .borderRadius(10)

        Text(this.gpsOk?'å½“å‰GPSåæ ‡ï¼š'+'\nç»åº¦ï¼š115.8379 .Â°E'+'\nçº¬åº¦ï¼š28.7045 Â°N':'å½“å‰GPSåæ ‡ï¼š'+'\nç»åº¦ï¼š115.**** Â°E'+'\nçº¬åº¦ï¼š28.**** Â°N')
          .fontSize(24)
          .width('60%')
          .fontColor('#138EF0')
          .backgroundColor('#ffe2f2ff')
          .borderRadius(30)
          .border({width:1,color:"#138EF0"})
          .padding(16)
          .borderRadius(10)
          .margin({top:20})

        Button(this.gpsOk?'å…³é—­GPSç²¾ç¡®æ˜¾ç¤º':'æ‰“å¼€GPSç²¾ç¡®æ˜¾ç¤º')
          .fontSize(16)
          .margin({top:10})
          .onClick(()=>{
            this.gpsOk=!this.gpsOk;
          })

        // ä¿®æ”¹ï¼šæ·»åŠ æ–¹å‘ç»‘å®š
        JoystickComponent({
          normalizedX: this.Xed,
          normalizedY: this.Yed,
          direction1: this.direction1
        })
          .position({ bottom: 15, left: 15 })
      }
      .height('100%')
      .width('100%')

      Row() {
        Text(this.BaiFen + '%')
          .lineHeight(50)
          .rotate({ angle: -90 })
          .padding(0)
        Slider({
          value: $$this.BaiFen,
          direction: Axis.Vertical,
          style: SliderStyle.InSet,
          step: 25,
          reverse: true
        })
          .showSteps(true)
          .selectedColor('#fffb7299')
          .height('50%')
          .align(Alignment.Center)
      }
      .position({ bottom: 10, right: 3 })
    }
  }

  // æ–°å¢ï¼šå°†æ•°å­—æ–¹å‘è½¬æ¢ä¸ºæ–‡å­—
  private getDirectionText(): string {
    switch (this.direction1) {
      case 1: {
        if('right'!=this.pre){
          this.pre='right';
          //ä¸‹å‘è®¾å¤‡
          this.poster.postUpper("[ORDER]right")
        }
        return 'right'
      };
      case 2: {
        if('under'!=this.pre){
          this.pre='under';
          //ä¸‹å‘è®¾å¤‡
          this.poster.postUpper("[ORDER]under")
        }

        return 'under'
      };
      case 3: {
        if('left'!=this.pre){
          this.pre='left';
          //ä¸‹å‘è®¾å¤‡
          this.poster.postUpper("[ORDER]left")
        }

        return 'left'
      };
      case 4: {
        if('up'!=this.pre){
          this.pre='up';
          //ä¸‹å‘è®¾å¤‡
          this.poster.postUpper("[ORDER]up")
        }

        return 'up'
      };
      default: {
        if('centen'!=this.pre){
          this.pre='centen';
          //ä¸‹å‘è®¾å¤‡
          this.poster.postUpper("[ORDER]centen")
        }

        return 'centen'
      };
    }
  }
}